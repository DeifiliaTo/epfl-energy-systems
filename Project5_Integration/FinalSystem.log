CPLEX 12.9.0.0: optimal integer solution; objective 9900212.118
24 MIP simplex iterations
0 branch-and-bound nodes
Edemand [*] :=
1  12237.1
2  12237.1
3  12237.1
4  12237.1
5   2646.4
;

Qheating [*,*]
:         1           2           3            4           6        :=
AA     2851.88    2780.58     1207.35      969.169      4509.7
AI     3190.73    3131.68        0         523.128      6211.33
BC     1539.72    1512.53        0         273.703      2923.34
BI      272.84     267.091       0          31.3329      557.679
BM     2177.61    2134.01        0         408.809      4121.38
BP      746.685    733.003       0         147.305      1382.93
BS     1627.08    1601.22      156.512     505.349      2610.27
CE     3060.17    2985.82     1250.99     1049.72       4813.94
CH     2907.18    2853.8         0         258.291      6117.18
CM      975.389    955.272       0         125.033      1956.61
CO      531.966    521.782       0          25.6128     1154.86
CRPP    721.778    708.05        0           0          1681.39
DIA     125.378    123.587      11.9562     41.8779      193.488
EL     1173.45    1157.52        0         121.965      2379.52
GC     2051.53    2014.48        0         391.211      3832.08
GR      411.598    398.643      56.0567     41.0322      868.129
IN     1562.2     1530.73        0         251.163      3029.32
MA     1467.12    1427.46        0           0          4110.62
ME      512.056    491.531       0           0          1818.67
MX     1671.82    1651.78        0          36.5923     3697.55
ODY     515.963    506.154     127.119     175.297       799.736
PH     1761.33    1740.58        0           0          4431.79
PO       44.29      43.3786      0           0.499354    100.782
TCV     110.546    102.196       0           0           869.385
;

Qheatingdemand :=
LowT    1   19103.2
LowT    2   18729.7
LowT    3    1502.94
LowT    4    3480.47
LowT    6   37483.7
MediumT 1   12907.1
MediumT 2   12643.1
MediumT 3    1307.05
MediumT 4    1896.62
MediumT 6   26688
;

Qheatingsupply [*] :=
    Boiler    500
     Cogen   2800.11
Geothermal  10000
HP1stageLT   1000
HP1stageMT   1000
  HP2stage   1000
      SOFC     30
;

mult [*] :=
      Boiler    10
       Cogen     9.70012
 ElecGridBuy  1000
ElecGridSell  1000
  Geothermal     1
  HP1stageLT    10
  HP1stageMT    10
    HP2stage     2.0103
  NatGasGrid  1000
          PV    16.7195
;

mult_t [*,*]
:                 1         2           3          4          5         6    :=
Boiler          0         0          0          0          0         10
Cogen           0         0          0          0          0          9.70012
ElecGridBuy    12.7645   12.4171     9.21635    9.29191    2.24497    0
ElecGridSell    0         0          0          0          0         18.3452
Geothermal      1         1          0.280999   0.537709   0          1
HP1stageLT     10        10          0          0          0         10
HP1stageMT     10        10          0          0          0         10
HP2stage        2.0103    1.37287    0          0          0          2.0103
NatGasGrid      0         0          0          0          0         58.8969
PV              2.7728    2.35895   16.7195     3.64188    4.01435    0
;

Flowin :=
Biogas      SOFC            109.729
Electricity ElecGridSell   1000
Natgas      Boiler          555.556
Natgas      Cogen          5499.04
;

Flowout :=
Electricity Cogen         2000
Electricity ElecGridBuy   1000
Electricity Geothermal    4800
Electricity PV             100
Electricity SOFC            58
Natgas      NatGasGrid    1000
;

FlowInUnit :=
Electricity ElecGridSell 6   18345.2
Electricity HP1stageLT   1    2069.68
Electricity HP1stageLT   2    2012.03
Electricity HP1stageLT   6    2242.62
Electricity HP1stageMT   1    2683.89
Electricity HP1stageMT   2    2628.44
Electricity HP1stageMT   6    2850.24
Electricity HP2stage     1     851.138
Electricity HP2stage     2     575.401
Electricity HP2stage     6     762.169
Natgas      Boiler       6    5555.56
Natgas      Cogen        6   53341.3
;

FlowOutUnit :=
Electricity Cogen       6   19400.2
Electricity ElecGridBuy 1   12764.5
Electricity ElecGridBuy 2   12417.1
Electricity ElecGridBuy 3    9216.35
Electricity ElecGridBuy 4    9291.91
Electricity ElecGridBuy 5    2244.97
Electricity Geothermal  1    4800
Electricity Geothermal  2    4800
Electricity Geothermal  3    1348.8
Electricity Geothermal  4    2581
Electricity Geothermal  6    4800
Electricity PV          1     277.28
Electricity PV          2     235.895
Electricity PV          3    1671.95
Electricity PV          4     364.188
Electricity PV          5     401.435
Natgas      NatGasGrid  6   58896.9
;

set Buildings :=
GC     GR     CH     CO     TCV    ME     PO     BM
CE     CM     PH     BP     IN     AA     CRPP   DIA
MA     BI     BC     BS     ODY    EL     MX     AI;

InvCost = 7167950

OpCost = 11623800

Tlmc_HP1stageMT [*] :=
1  279.497
2  280.497
3  282.497
4  284.497
5  285.497
6  276.497
;

CO2 = 4450570

heat_recovery :=
DC      1    357.011
DC      2    356.967
DC      3    335.21
DC      4    343.394
DC      6    357.897
Vent    1      0.549
Vent    2      0.536
Vent    3      0.263
Vent    4      0.222
Vent    5      0.131
Vent    6      0.789
Vent_HP 1   1577.79
Vent_HP 2   1542.22
Vent_HP 3    757.489
Vent_HP 4    638.682
Vent_HP 5    428.859
Vent_HP 6   2023.78
;

use_recovery [*] :=
;

mult_t [*,*]
:                 1         2           3          4          5         6    :=
Boiler          0         0          0          0          0         10
Cogen           0         0          0          0          0          9.70012
ElecGridBuy    12.7645   12.4171     9.21635    9.29191    2.24497    0
ElecGridSell    0         0          0          0          0         18.3452
Geothermal      1         1          0.280999   0.537709   0          1
HP1stageLT     10        10          0          0          0         10
HP1stageMT     10        10          0          0          0         10
HP2stage        2.0103    1.37287    0          0          0          2.0103
NatGasGrid      0         0          0          0          0         58.8969
PV              2.7728    2.35895   16.7195     3.64188    4.01435    0
;

use_t [*,*]
:              1   2   3   4   5   6    :=
Boiler         0   0   0   0   0   1
Cogen          0   0   0   0   0   1
ElecGridBuy    1   1   1   1   1   0
ElecGridSell   0   0   0   0   0   1
Geothermal     1   1   1   1   0   1
HP1stageLT     1   1   0   0   0   1
HP1stageMT     1   1   0   0   0   1
HP2stage       1   1   0   0   0   1
NatGasGrid     0   0   0   0   0   1
PV             1   1   1   1   1   0
;

ampl: 