CPLEX 12.9.0.0: optimal integer solution; objective 1054642.472
52 MIP simplex iterations
0 branch-and-bound nodes
Edemand [*] :=
1  12237.1
2  12237.1
3  12237.1
4  12237.1
5   2646.4
;

Qheating [*,*]
:         1           2           3            4           6        :=
AA     2851.88    2780.58     1207.35      969.169      4509.7
AI     3190.73    3131.68        0         523.128      6211.33
BC     1539.72    1512.53        0         273.703      2923.34
BI      272.84     267.091       0          31.3329      557.679
BM     2177.61    2134.01        0         408.809      4121.38
BP      746.685    733.003       0         147.305      1382.93
BS     1627.08    1601.22      156.512     505.349      2610.27
CE     3060.17    2985.82     1250.99     1049.72       4813.94
CH     2907.18    2853.8         0         258.291      6117.18
CM      975.389    955.272       0         125.033      1956.61
CO      531.966    521.782       0          25.6128     1154.86
CRPP    721.778    708.05        0           0          1681.39
DIA     125.378    123.587      11.9562     41.8779      193.488
EL     1173.45    1157.52        0         121.965      2379.52
GC     2051.53    2014.48        0         391.211      3832.08
GR      411.598    398.643      56.0567     41.0322      868.129
IN     1562.2     1530.73        0         251.163      3029.32
MA     1467.12    1427.46        0           0          4110.62
ME      512.056    491.531       0           0          1818.67
MX     1671.82    1651.78        0          36.5923     3697.55
ODY     515.963    506.154     127.119     175.297       799.736
PH     1761.33    1740.58        0           0          4431.79
PO       44.29      43.3786      0           0.499354    100.782
TCV     110.546    102.196       0           0           869.385
;

Qheatingdemand :=
LowT    1   19103.2
LowT    2   18729.7
LowT    3    1502.94
LowT    4    3480.47
LowT    6   37483.7
MediumT 1   12907.1
MediumT 2   12643.1
MediumT 3    1307.05
MediumT 4    1896.62
MediumT 6   26688
;

Qheatingsupply [*] :=
    Boiler    500
     Cogen   2800.11
Geothermal  10000
HP1stageLT   1000
HP1stageMT   1000
  HP2stage   1000
      SOFC     30
;

mult [*] :=
       Cogen    11.4854
 ElecGridBuy  1000
ElecGridSell  1000
    HP2stage    31.6533
  NatGasGrid  1000
;

mult_t :=
Cogen        6   11.4854
ElecGridBuy  1   25.6387
ElecGridBuy  2   25.2366
ElecGridBuy  3   12.9065
ElecGridBuy  4   13.4913
ElecGridBuy  5    2.6464
ElecGridSell 6   10.9701
HP2stage     1   31.6533
HP2stage     2   31.0159
HP2stage     3    2.47478
HP2stage     4    5.0337
HP2stage     6   31.6533
NatGasGrid   6   63.1589
;

Flowin :=
Biogas      SOFC            109.729
Electricity ElecGridSell   1000
Natgas      Boiler          555.556
Natgas      Cogen          5499.04
;

Flowout :=
Electricity Cogen         2000
Electricity ElecGridBuy   1000
Electricity Geothermal    4800
Electricity PV             100
Electricity SOFC            58
Natgas      NatGasGrid    1000
;

FlowInUnit :=
Electricity ElecGridSell 6   10970.1
Electricity HP2stage     1   13401.6
Electricity HP2stage     2   12999.5
Electricity HP2stage     3     669.386
Electricity HP2stage     4    1254.2
Electricity HP2stage     6   12000.8
Natgas      Cogen        6   63158.9
;

FlowOutUnit :=
Electricity Cogen       6   22970.9
Electricity ElecGridBuy 1   25638.7
Electricity ElecGridBuy 2   25236.6
Electricity ElecGridBuy 3   12906.5
Electricity ElecGridBuy 4   13491.3
Electricity ElecGridBuy 5    2646.4
Natgas      NatGasGrid  6   63158.9
;

set Buildings :=
GC     GR     CH     CO     TCV    ME     PO     BM
CE     CM     PH     BP     IN     AA     CRPP   DIA
MA     BI     BC     BS     ODY    EL     MX     AI;

InvCost = 3005830

OpCost = 17769700

Tlmc_HP1stageMT [*] :=
1  279.497
2  280.497
3  282.497
4  284.497
5  285.497
6  276.497
;

CO2 = 566846

heat_recovery :=
DC      1    357.011
DC      2    356.967
DC      3    335.21
DC      4    343.394
DC      6    357.897
Vent    1      0.549
Vent    2      0.536
Vent    3      0.263
Vent    4      0.222
Vent    5      0.131
Vent    6      0.789
Vent_HP 1   1577.79
Vent_HP 2   1542.22
Vent_HP 3    757.489
Vent_HP 4    638.682
Vent_HP 5    428.859
Vent_HP 6   2023.78
;

use_recovery [*] :=
     DC  1
;

mult_t :=
Cogen        6   11.4854
ElecGridBuy  1   25.6387
ElecGridBuy  2   25.2366
ElecGridBuy  3   12.9065
ElecGridBuy  4   13.4913
ElecGridBuy  5    2.6464
ElecGridSell 6   10.9701
HP2stage     1   31.6533
HP2stage     2   31.0159
HP2stage     3    2.47478
HP2stage     4    5.0337
HP2stage     6   31.6533
NatGasGrid   6   63.1589
;

use_t :=
Cogen        6   1
ElecGridBuy  1   1
ElecGridBuy  2   1
ElecGridBuy  3   1
ElecGridBuy  4   1
ElecGridBuy  5   1
ElecGridSell 6   1
HP2stage     1   1
HP2stage     2   1
HP2stage     3   1
HP2stage     4   1
HP2stage     6   1
NatGasGrid   6   1
;

ampl: reset;
ampl: include FinalSystem.run
CPLEX 12.9.0.0: optimal integer solution; objective 1493659.194
50 MIP simplex iterations
0 branch-and-bound nodes
absmipgap = 2.32831e-10, relmipgap = 1.55879e-16
Edemand [*] :=
1  12237.1
2  12237.1
3  12237.1
4  12237.1
5   2646.4
;

Qheating [*,*]
:         1           2           3            4           6        :=
AA     2851.88    2780.58     1207.35      969.169      4509.7
AI     3190.73    3131.68        0         523.128      6211.33
BC     1539.72    1512.53        0         273.703      2923.34
BI      272.84     267.091       0          31.3329      557.679
BM     2177.61    2134.01        0         408.809      4121.38
BP      746.685    733.003       0         147.305      1382.93
BS     1627.08    1601.22      156.512     505.349      2610.27
CE     3060.17    2985.82     1250.99     1049.72       4813.94
CH     2907.18    2853.8         0         258.291      6117.18
CM      975.389    955.272       0         125.033      1956.61
CO      531.966    521.782       0          25.6128     1154.86
CRPP    721.778    708.05        0           0          1681.39
DIA     125.378    123.587      11.9562     41.8779      193.488
EL     1173.45    1157.52        0         121.965      2379.52
GC     2051.53    2014.48        0         391.211      3832.08
GR      411.598    398.643      56.0567     41.0322      868.129
IN     1562.2     1530.73        0         251.163      3029.32
MA     1467.12    1427.46        0           0          4110.62
ME      512.056    491.531       0           0          1818.67
MX     1671.82    1651.78        0          36.5923     3697.55
ODY     515.963    506.154     127.119     175.297       799.736
PH     1761.33    1740.58        0           0          4431.79
PO       44.29      43.3786      0           0.499354    100.782
TCV     110.546    102.196       0           0           869.385
;

Qheatingdemand :=
LowT    1   19103.2
LowT    2   18729.7
LowT    3    1502.94
LowT    4    3480.47
LowT    6   37483.7
MediumT 1   12907.1
MediumT 2   12643.1
MediumT 3    1307.05
MediumT 4    1896.62
MediumT 6   26688
;

Qheatingsupply [*] :=
    Boiler    500
     Cogen   2800.11
Geothermal  10000
HP1stageLT   1000
HP1stageMT   1000
  HP2stage   1000
      SOFC     30
;

mult [*] :=
       Cogen    11.4854
 ElecGridBuy  1000
ElecGridSell  1000
    HP2stage    31.6533
  NatGasGrid  1000
;

mult_t :=
Cogen        6   11.4854
ElecGridBuy  1   25.6387
ElecGridBuy  2   25.2366
ElecGridBuy  3   12.9065
ElecGridBuy  4   13.4913
ElecGridBuy  5    2.6464
ElecGridSell 6   10.9701
HP2stage     1   31.6533
HP2stage     2   31.0159
HP2stage     3    2.47478
HP2stage     4    5.0337
HP2stage     6   31.6533
NatGasGrid   6   63.1589
;

Flowin :=
Biogas      SOFC            109.729
Electricity ElecGridSell   1000
Natgas      Boiler          555.556
Natgas      Cogen          5499.04
;

Flowout :=
Electricity Cogen         2000
Electricity ElecGridBuy   1000
Electricity Geothermal    4800
Electricity PV             100
Electricity SOFC            58
Natgas      NatGasGrid    1000
;

FlowInUnit :=
Electricity ElecGridSell 6   10970.1
Electricity HP2stage     1   13401.6
Electricity HP2stage     2   12999.5
Electricity HP2stage     3     669.386
Electricity HP2stage     4    1254.2
Electricity HP2stage     6   12000.8
Natgas      Cogen        6   63158.9
;

FlowOutUnit :=
Electricity Cogen       6   22970.9
Electricity ElecGridBuy 1   25638.7
Electricity ElecGridBuy 2   25236.6
Electricity ElecGridBuy 3   12906.5
Electricity ElecGridBuy 4   13491.3
Electricity ElecGridBuy 5    2646.4
Natgas      NatGasGrid  6   63158.9
;

set Buildings :=
GC     GR     CH     CO     TCV    ME     PO     BM
CE     CM     PH     BP     IN     AA     CRPP   DIA
MA     BI     BC     BS     ODY    EL     MX     AI;

InvCost = 3005830

OpCost = 17769700

Tlmc_HP1stageMT [*] :=
1  279.497
2  280.497
3  282.497
4  284.497
5  285.497
6  276.497
;

CO2 = 566846

heat_recovery :=
DC      1    357.011
DC      2    356.967
DC      3    335.21
DC      4    343.394
DC      6    357.897
Vent    1      0.549
Vent    2      0.536
Vent    3      0.263
Vent    4      0.222
Vent    5      0.131
Vent    6      0.789
Vent_HP 1   1577.79
Vent_HP 2   1542.22
Vent_HP 3    757.489
Vent_HP 4    638.682
Vent_HP 5    428.859
Vent_HP 6   2023.78
;

use_recovery [*] :=
     DC  1
;

mult_t :=
Cogen        6   11.4854
ElecGridBuy  1   25.6387
ElecGridBuy  2   25.2366
ElecGridBuy  3   12.9065
ElecGridBuy  4   13.4913
ElecGridBuy  5    2.6464
ElecGridSell 6   10.9701
HP2stage     1   31.6533
HP2stage     2   31.0159
HP2stage     3    2.47478
HP2stage     4    5.0337
HP2stage     6   31.6533
NatGasGrid   6   63.1589
;

use_t :=
Cogen        6   1
ElecGridBuy  1   1
ElecGridBuy  2   1
ElecGridBuy  3   1
ElecGridBuy  4   1
ElecGridBuy  5   1
ElecGridSell 6   1
HP2stage     1   1
HP2stage     2   1
HP2stage     3   1
HP2stage     4   1
HP2stage     6   1
NatGasGrid   6   1
;

ampl: reset;
ampl: include FinalSystem.run
CPLEX 12.9.0.0: optimal integer solution; objective 7253224.035
30 MIP simplex iterations
0 branch-and-bound nodes
Edemand [*] :=
1  12237.1
2  12237.1
3  12237.1
4  12237.1
5   2646.4
;

Qheating [*,*]
:         1           2           3            4           6        :=
AA     2851.88    2780.58     1207.35      969.169      4509.7
AI     3190.73    3131.68        0         523.128      6211.33
BC     1539.72    1512.53        0         273.703      2923.34
BI      272.84     267.091       0          31.3329      557.679
BM     2177.61    2134.01        0         408.809      4121.38
BP      746.685    733.003       0         147.305      1382.93
BS     1627.08    1601.22      156.512     505.349      2610.27
CE     3060.17    2985.82     1250.99     1049.72       4813.94
CH     2907.18    2853.8         0         258.291      6117.18
CM      975.389    955.272       0         125.033      1956.61
CO      531.966    521.782       0          25.6128     1154.86
CRPP    721.778    708.05        0           0          1681.39
DIA     125.378    123.587      11.9562     41.8779      193.488
EL     1173.45    1157.52        0         121.965      2379.52
GC     2051.53    2014.48        0         391.211      3832.08
GR      411.598    398.643      56.0567     41.0322      868.129
IN     1562.2     1530.73        0         251.163      3029.32
MA     1467.12    1427.46        0           0          4110.62
ME      512.056    491.531       0           0          1818.67
MX     1671.82    1651.78        0          36.5923     3697.55
ODY     515.963    506.154     127.119     175.297       799.736
PH     1761.33    1740.58        0           0          4431.79
PO       44.29      43.3786      0           0.499354    100.782
TCV     110.546    102.196       0           0           869.385
;

Qheatingdemand :=
LowT    1   19103.2
LowT    2   18729.7
LowT    3    1502.94
LowT    4    3480.47
LowT    6   37483.7
MediumT 1   12907.1
MediumT 2   12643.1
MediumT 3    1307.05
MediumT 4    1896.62
MediumT 6   26688
;

Qheatingsupply [*] :=
    Boiler    500
     Cogen   2800.11
Geothermal  10000
HP1stageLT   1000
HP1stageMT   1000
  HP2stage   1000
      SOFC     30
;

mult [*] :=
      Boiler    10
       Cogen     9.70012
 ElecGridBuy  1000
ElecGridSell  1000
  Geothermal     0.537709
  HP1stageLT    10
  HP1stageMT    10
    HP2stage     6.63321
  NatGasGrid  1000
          PV    16.7195
;

mult_t [*,*]
:                  1           2           3          4          5       :=
ElecGridBuy    16.9408     16.5736      9.21635    9.29191    2.24497
Geothermal      0.537709    0.537709    0.280999   0.537709   0
HP1stageLT     10          10           0          0          0
HP1stageMT     10          10           0          0          0
HP2stage        6.63321     5.99577     0          0          0
PV              2.7728      2.35895    16.7195     3.64188    4.01435

:                  6        :=
Boiler         10
Cogen           9.70012
ElecGridSell   14.3735
Geothermal      0.537709
HP1stageLT     10
HP1stageMT     10
HP2stage        6.63321
NatGasGrid     58.8969
;

Flowin :=
Biogas      SOFC            109.729
Electricity ElecGridSell   1000
Natgas      Boiler          555.556
Natgas      Cogen          5499.04
;

Flowout :=
Electricity Cogen         2000
Electricity ElecGridBuy   1000
Electricity Geothermal    4800
Electricity PV             100
Electricity SOFC            58
Natgas      NatGasGrid    1000
;

FlowInUnit :=
Electricity ElecGridSell 6   14373.5
Electricity HP1stageLT   1    2069.68
Electricity HP1stageLT   2    2012.03
Electricity HP1stageLT   6    2242.62
Electricity HP1stageMT   1    2683.89
Electricity HP1stageMT   2    2628.44
Electricity HP1stageMT   6    2850.24
Electricity HP2stage     1    2808.43
Electricity HP2stage     2    2512.97
Electricity HP2stage     6    2514.86
Natgas      Boiler       6    5555.56
Natgas      Cogen        6   53341.3
;

FlowOutUnit :=
Electricity Cogen       6   19400.2
Electricity ElecGridBuy 1   16940.8
Electricity ElecGridBuy 2   16573.6
Electricity ElecGridBuy 3    9216.35
Electricity ElecGridBuy 4    9291.91
Electricity ElecGridBuy 5    2244.97
Electricity Geothermal  1    2581
Electricity Geothermal  2    2581
Electricity Geothermal  3    1348.8
Electricity Geothermal  4    2581
Electricity Geothermal  6    2581
Electricity PV          1     277.28
Electricity PV          2     235.895
Electricity PV          3    1671.95
Electricity PV          4     364.188
Electricity PV          5     401.435
Natgas      NatGasGrid  6   58896.9
;

set Buildings :=
GC     GR     CH     CO     TCV    ME     PO     BM
CE     CM     PH     BP     IN     AA     CRPP   DIA
MA     BI     BC     BS     ODY    EL     MX     AI;

InvCost = 5641440

OpCost = 12772500

Tlmc_HP1stageMT [*] :=
1  279.497
2  280.497
3  282.497
4  284.497
5  285.497
6  276.497
;

CO2 = 412809

heat_recovery :=
DC      1    357.011
DC      2    356.967
DC      3    335.21
DC      4    343.394
DC      6    357.897
Vent    1      0.549
Vent    2      0.536
Vent    3      0.263
Vent    4      0.222
Vent    5      0.131
Vent    6      0.789
Vent_HP 1   1577.79
Vent_HP 2   1542.22
Vent_HP 3    757.489
Vent_HP 4    638.682
Vent_HP 5    428.859
Vent_HP 6   2023.78
;

use_recovery [*] :=
;

mult_t [*,*]
:                  1           2           3          4          5       :=
ElecGridBuy    16.9408     16.5736      9.21635    9.29191    2.24497
Geothermal      0.537709    0.537709    0.280999   0.537709   0
HP1stageLT     10          10           0          0          0
HP1stageMT     10          10           0          0          0
HP2stage        6.63321     5.99577     0          0          0
PV              2.7728      2.35895    16.7195     3.64188    4.01435

:                  6        :=
Boiler         10
Cogen           9.70012
ElecGridSell   14.3735
Geothermal      0.537709
HP1stageLT     10
HP1stageMT     10
HP2stage        6.63321
NatGasGrid     58.8969
;

use_t [*,*]
:              1   2   3   4   5   6    :=
Boiler         0   0   0   0   0   1
Cogen          0   0   0   0   0   1
ElecGridBuy    1   1   1   1   1   0
ElecGridSell   0   0   0   0   0   1
Geothermal     1   1   1   1   0   1
HP1stageLT     1   1   0   0   0   1
HP1stageMT     1   1   0   0   0   1
HP2stage       1   1   0   0   0   1
NatGasGrid     0   0   0   0   0   1
PV             1   1   1   1   1   0
;

ampl: reset;
ampl: include FinalSystem.run
CPLEX 12.9.0.0: optimal integer solution; objective 4055129.025
17 MIP simplex iterations
0 branch-and-bound nodes
absmipgap = 4.65661e-10, relmipgap = 1.14833e-16
Edemand [*] :=
1  12237.1
2  12237.1
3  12237.1
4  12237.1
5   2646.4
;

Qheating [*,*]
:         1           2           3            4           6        :=
AA     2851.88    2780.58     1207.35      969.169      4509.7
AI     3190.73    3131.68        0         523.128      6211.33
BC     1539.72    1512.53        0         273.703      2923.34
BI      272.84     267.091       0          31.3329      557.679
BM     2177.61    2134.01        0         408.809      4121.38
BP      746.685    733.003       0         147.305      1382.93
BS     1627.08    1601.22      156.512     505.349      2610.27
CE     3060.17    2985.82     1250.99     1049.72       4813.94
CH     2907.18    2853.8         0         258.291      6117.18
CM      975.389    955.272       0         125.033      1956.61
CO      531.966    521.782       0          25.6128     1154.86
CRPP    721.778    708.05        0           0          1681.39
DIA     125.378    123.587      11.9562     41.8779      193.488
EL     1173.45    1157.52        0         121.965      2379.52
GC     2051.53    2014.48        0         391.211      3832.08
GR      411.598    398.643      56.0567     41.0322      868.129
IN     1562.2     1530.73        0         251.163      3029.32
MA     1467.12    1427.46        0           0          4110.62
ME      512.056    491.531       0           0          1818.67
MX     1671.82    1651.78        0          36.5923     3697.55
ODY     515.963    506.154     127.119     175.297       799.736
PH     1761.33    1740.58        0           0          4431.79
PO       44.29      43.3786      0           0.499354    100.782
TCV     110.546    102.196       0           0           869.385
;

Qheatingdemand :=
LowT    1   19103.2
LowT    2   18729.7
LowT    3    1502.94
LowT    4    3480.47
LowT    6   37483.7
MediumT 1   12907.1
MediumT 2   12643.1
MediumT 3    1307.05
MediumT 4    1896.62
MediumT 6   26688
;

Qheatingsupply [*] :=
    Boiler    500
     Cogen   2800.11
Geothermal  10000
HP1stageLT   1000
HP1stageMT   1000
  HP2stage   1000
      SOFC     30
;

mult [*] :=
      Boiler    10
       Cogen   225
 ElecGridBuy  1000
ElecGridSell  1000
  Geothermal     1
  HP1stageLT    10
  HP1stageMT    10
    HP2stage    50
  NatGasGrid  1000
          PV  1000
;

mult_t [*,*]
:                 1         2           3          4          5         6    :=
ElecGridBuy    12.7645   12.4171     9.21635    9.29191    2.24497   13.2484
Geothermal      1         1          0.280999   0.537709   0          1
HP1stageLT     10        10          0          0          0         10
HP1stageMT     10        10          0          0          0         10
HP2stage        2.0103    1.37287    0          0          0         34.1717
PV              2.7728    2.35895   16.7195     3.64188    4.01435    0
;

Flowin :=
Biogas      SOFC            109.729
Electricity ElecGridSell   1000
Natgas      Boiler          555.556
Natgas      Cogen          5499.04
;

Flowout :=
Electricity Cogen         2000
Electricity ElecGridBuy   1000
Electricity Geothermal    4800
Electricity PV             100
Electricity SOFC            58
Natgas      NatGasGrid    1000
;

FlowInUnit :=
Electricity HP1stageLT 1    2069.68
Electricity HP1stageLT 2    2012.03
Electricity HP1stageLT 6    2242.62
Electricity HP1stageMT 1    2683.89
Electricity HP1stageMT 2    2628.44
Electricity HP1stageMT 6    2850.24
Electricity HP2stage   1     851.138
Electricity HP2stage   2     575.401
Electricity HP2stage   6   12955.6
;

FlowOutUnit :=
Electricity ElecGridBuy 1   12764.5
Electricity ElecGridBuy 2   12417.1
Electricity ElecGridBuy 3    9216.35
Electricity ElecGridBuy 4    9291.91
Electricity ElecGridBuy 5    2244.97
Electricity ElecGridBuy 6   13248.4
Electricity Geothermal  1    4800
Electricity Geothermal  2    4800
Electricity Geothermal  3    1348.8
Electricity Geothermal  4    2581
Electricity Geothermal  6    4800
Electricity PV          1     277.28
Electricity PV          2     235.895
Electricity PV          3    1671.95
Electricity PV          4     364.188
Electricity PV          5     401.435
;

set Buildings :=
GC     GR     CH     CO     TCV    ME     PO     BM
CE     CM     PH     BP     IN     AA     CRPP   DIA
MA     BI     BC     BS     ODY    EL     MX     AI;

InvCost = 20141600

OpCost = 10094900

Tlmc_HP1stageMT [*] :=
1  279.497
2  280.497
3  282.497
4  284.497
5  285.497
6  276.497
;

CO2 = 353323

heat_recovery :=
DC      1    357.011
DC      2    356.967
DC      3    335.21
DC      4    343.394
DC      6    357.897
Vent    1      0.549
Vent    2      0.536
Vent    3      0.263
Vent    4      0.222
Vent    5      0.131
Vent    6      0.789
Vent_HP 1   1577.79
Vent_HP 2   1542.22
Vent_HP 3    757.489
Vent_HP 4    638.682
Vent_HP 5    428.859
Vent_HP 6   2023.78
;

use_recovery [*] :=
;

mult_t [*,*]
:                 1         2           3          4          5         6    :=
ElecGridBuy    12.7645   12.4171     9.21635    9.29191    2.24497   13.2484
Geothermal      1         1          0.280999   0.537709   0          1
HP1stageLT     10        10          0          0          0         10
HP1stageMT     10        10          0          0          0         10
HP2stage        2.0103    1.37287    0          0          0         34.1717
PV              2.7728    2.35895   16.7195     3.64188    4.01435    0
;

use_t [*,*]
:              1   2   3   4   5   6    :=
ElecGridBuy    1   1   1   1   1   1
Geothermal     1   1   1   1   0   1
HP1stageLT     1   1   0   0   0   1
HP1stageMT     1   1   0   0   0   1
HP2stage       1   1   0   0   0   1
PV             1   1   1   1   1   0
;

ampl: reset;
ampl: include FinalSystem.run
CPLEX 12.9.0.0: optimal integer solution; objective -34052601910
30 MIP simplex iterations
0 branch-and-bound nodes
Edemand [*] :=
1  12237.1
2  12237.1
3  12237.1
4  12237.1
5   2646.4
;

Qheating [*,*]
:         1           2           3            4           6        :=
AA     2851.88    2780.58     1207.35      969.169      4509.7
AI     3190.73    3131.68        0         523.128      6211.33
BC     1539.72    1512.53        0         273.703      2923.34
BI      272.84     267.091       0          31.3329      557.679
BM     2177.61    2134.01        0         408.809      4121.38
BP      746.685    733.003       0         147.305      1382.93
BS     1627.08    1601.22      156.512     505.349      2610.27
CE     3060.17    2985.82     1250.99     1049.72       4813.94
CH     2907.18    2853.8         0         258.291      6117.18
CM      975.389    955.272       0         125.033      1956.61
CO      531.966    521.782       0          25.6128     1154.86
CRPP    721.778    708.05        0           0          1681.39
DIA     125.378    123.587      11.9562     41.8779      193.488
EL     1173.45    1157.52        0         121.965      2379.52
GC     2051.53    2014.48        0         391.211      3832.08
GR      411.598    398.643      56.0567     41.0322      868.129
IN     1562.2     1530.73        0         251.163      3029.32
MA     1467.12    1427.46        0           0          4110.62
ME      512.056    491.531       0           0          1818.67
MX     1671.82    1651.78        0          36.5923     3697.55
ODY     515.963    506.154     127.119     175.297       799.736
PH     1761.33    1740.58        0           0          4431.79
PO       44.29      43.3786      0           0.499354    100.782
TCV     110.546    102.196       0           0           869.385
;

Qheatingdemand :=
LowT    1   19103.2
LowT    2   18729.7
LowT    3    1502.94
LowT    4    3480.47
LowT    6   37483.7
MediumT 1   12907.1
MediumT 2   12643.1
MediumT 3    1307.05
MediumT 4    1896.62
MediumT 6   26688
;

Qheatingsupply [*] :=
    Boiler    500
     Cogen   2800.11
Geothermal  10000
HP1stageLT   1000
HP1stageMT   1000
  HP2stage   1000
      SOFC     30
;

mult [*] :=
      Boiler    10
       Cogen   225
 ElecGridBuy  1000
ElecGridSell  1000
  Geothermal     1
  HP1stageLT    10
  HP1stageMT    10
    HP2stage    50
  NatGasGrid  1000
          PV  1000
        SOFC  8620
;

mult_t [*,*]
:                  1           2           3            4           5        :=
Cogen            11.4318     11.2042      1.00353      1.92032      0
ElecGridBuy     989.373     989.829    1000         1000         1000
ElecGridSell   1000        1000         989.77       991.604      997.354
NatGasGrid       62.8639     61.6121      5.51844     10.5599       0

:                  6        :=
Cogen            22.9176
ElecGridBuy     954.165
ElecGridSell   1000
NatGasGrid      126.025
;

Flowin :=
Biogas      SOFC            109.729
Electricity ElecGridSell   1000
Natgas      Boiler          555.556
Natgas      Cogen          5499.04
;

Flowout :=
Electricity Cogen         2000
Electricity ElecGridBuy   1000
Electricity Geothermal    4800
Electricity PV             100
Electricity SOFC            58
Natgas      NatGasGrid    1000
;

FlowInUnit :=
Electricity ElecGridSell 1    1e+06
Electricity ElecGridSell 2    1e+06
Electricity ElecGridSell 3   989770
Electricity ElecGridSell 4   991604
Electricity ElecGridSell 5   997354
Electricity ElecGridSell 6    1e+06
Natgas      Cogen        1    62863.9
Natgas      Cogen        2    61612.1
Natgas      Cogen        3     5518.44
Natgas      Cogen        4    10559.9
Natgas      Cogen        6   126025
;

FlowOutUnit :=
Electricity Cogen       1    22863.6
Electricity Cogen       2    22408.3
Electricity Cogen       3     2007.06
Electricity Cogen       4     3840.63
Electricity Cogen       6    45835.1
Electricity ElecGridBuy 1   989373
Electricity ElecGridBuy 2   989829
Electricity ElecGridBuy 3    1e+06
Electricity ElecGridBuy 4    1e+06
Electricity ElecGridBuy 5    1e+06
Electricity ElecGridBuy 6   954165
Natgas      NatGasGrid  1    62863.9
Natgas      NatGasGrid  2    61612.1
Natgas      NatGasGrid  3     5518.44
Natgas      NatGasGrid  4    10559.9
Natgas      NatGasGrid  6   126025
;

set Buildings :=
GC     GR     CH     CO     TCV    ME     PO     BM
CE     CM     PH     BP     IN     AA     CRPP   DIA
MA     BI     BC     BS     ODY    EL     MX     AI;

InvCost = 512266000

OpCost = 3383210000

Tlmc_HP1stageMT [*] :=
1  279.497
2  280.497
3  282.497
4  284.497
5  285.497
6  276.497
;

CO2 = 100667000

heat_recovery :=
DC      1    357.011
DC      2    356.967
DC      3    335.21
DC      4    343.394
DC      6    357.897
Vent    1      0.549
Vent    2      0.536
Vent    3      0.263
Vent    4      0.222
Vent    5      0.131
Vent    6      0.789
Vent_HP 1   1577.79
Vent_HP 2   1542.22
Vent_HP 3    757.489
Vent_HP 4    638.682
Vent_HP 5    428.859
Vent_HP 6   2023.78
;

use_recovery [*] :=
;

mult_t [*,*]
:                  1           2           3            4           5        :=
Cogen            11.4318     11.2042      1.00353      1.92032      0
ElecGridBuy     989.373     989.829    1000         1000         1000
ElecGridSell   1000        1000         989.77       991.604      997.354
NatGasGrid       62.8639     61.6121      5.51844     10.5599       0

:                  6        :=
Cogen            22.9176
ElecGridBuy     954.165
ElecGridSell   1000
NatGasGrid      126.025
;

use_t [*,*]
:              1   2   3   4   5   6    :=
Cogen          1   1   1   1   0   1
ElecGridBuy    1   1   1   1   1   1
ElecGridSell   1   1   1   1   1   1
NatGasGrid     1   1   1   1   0   1
;

ampl: reset;
ampl: include FinalSystem.run
CPLEX 12.9.0.0: optimal integer solution; objective 9413355.15
32 MIP simplex iterations
0 branch-and-bound nodes
Edemand [*] :=
1  12237.1
2  12237.1
3  12237.1
4  12237.1
5   2646.4
;

Qheating [*,*]
:         1           2           3            4           6        :=
AA     2851.88    2780.58     1207.35      969.169      4509.7
AI     3190.73    3131.68        0         523.128      6211.33
BC     1539.72    1512.53        0         273.703      2923.34
BI      272.84     267.091       0          31.3329      557.679
BM     2177.61    2134.01        0         408.809      4121.38
BP      746.685    733.003       0         147.305      1382.93
BS     1627.08    1601.22      156.512     505.349      2610.27
CE     3060.17    2985.82     1250.99     1049.72       4813.94
CH     2907.18    2853.8         0         258.291      6117.18
CM      975.389    955.272       0         125.033      1956.61
CO      531.966    521.782       0          25.6128     1154.86
CRPP    721.778    708.05        0           0          1681.39
DIA     125.378    123.587      11.9562     41.8779      193.488
EL     1173.45    1157.52        0         121.965      2379.52
GC     2051.53    2014.48        0         391.211      3832.08
GR      411.598    398.643      56.0567     41.0322      868.129
IN     1562.2     1530.73        0         251.163      3029.32
MA     1467.12    1427.46        0           0          4110.62
ME      512.056    491.531       0           0          1818.67
MX     1671.82    1651.78        0          36.5923     3697.55
ODY     515.963    506.154     127.119     175.297       799.736
PH     1761.33    1740.58        0           0          4431.79
PO       44.29      43.3786      0           0.499354    100.782
TCV     110.546    102.196       0           0           869.385
;

Qheatingdemand :=
LowT    1   19103.2
LowT    2   18729.7
LowT    3    1502.94
LowT    4    3480.47
LowT    6   37483.7
MediumT 1   12907.1
MediumT 2   12643.1
MediumT 3    1307.05
MediumT 4    1896.62
MediumT 6   26688
;

Qheatingsupply [*] :=
    Boiler    500
     Cogen   2800.11
Geothermal  10000
HP1stageLT   1000
HP1stageMT   1000
  HP2stage   1000
      SOFC     30
;

mult [*] :=
      Boiler    10
       Cogen     9.70012
 ElecGridBuy  1000
ElecGridSell  1000
  Geothermal     0.537709
  HP1stageLT    10
  HP1stageMT    10
    HP2stage     6.63321
  NatGasGrid  1000
          PV    16.7195
;

mult_t [*,*]
:                  1           2           3          4          5       :=
ElecGridBuy    16.9408     16.5736      9.21635    9.29191    2.24497
Geothermal      0.537709    0.537709    0.280999   0.537709   0
HP1stageLT     10          10           0          0          0
HP1stageMT     10          10           0          0          0
HP2stage        6.63321     5.99577     0          0          0
PV              2.7728      2.35895    16.7195     3.64188    4.01435

:                  6        :=
Boiler         10
Cogen           9.70012
ElecGridSell   14.3735
Geothermal      0.537709
HP1stageLT     10
HP1stageMT     10
HP2stage        6.63321
NatGasGrid     58.8969
;

Flowin :=
Biogas      SOFC            109.729
Electricity ElecGridSell   1000
Natgas      Boiler          555.556
Natgas      Cogen          5499.04
;

Flowout :=
Electricity Cogen         2000
Electricity ElecGridBuy   1000
Electricity Geothermal    4800
Electricity PV             100
Electricity SOFC            58
Natgas      NatGasGrid    1000
;

FlowInUnit :=
Electricity ElecGridSell 6   14373.5
Electricity HP1stageLT   1    2069.68
Electricity HP1stageLT   2    2012.03
Electricity HP1stageLT   6    2242.62
Electricity HP1stageMT   1    2683.89
Electricity HP1stageMT   2    2628.44
Electricity HP1stageMT   6    2850.24
Electricity HP2stage     1    2808.43
Electricity HP2stage     2    2512.97
Electricity HP2stage     6    2514.86
Natgas      Boiler       6    5555.56
Natgas      Cogen        6   53341.3
;

FlowOutUnit :=
Electricity Cogen       6   19400.2
Electricity ElecGridBuy 1   16940.8
Electricity ElecGridBuy 2   16573.6
Electricity ElecGridBuy 3    9216.35
Electricity ElecGridBuy 4    9291.91
Electricity ElecGridBuy 5    2244.97
Electricity Geothermal  1    2581
Electricity Geothermal  2    2581
Electricity Geothermal  3    1348.8
Electricity Geothermal  4    2581
Electricity Geothermal  6    2581
Electricity PV          1     277.28
Electricity PV          2     235.895
Electricity PV          3    1671.95
Electricity PV          4     364.188
Electricity PV          5     401.435
Natgas      NatGasGrid  6   58896.9
;

set Buildings :=
GC     GR     CH     CO     TCV    ME     PO     BM
CE     CM     PH     BP     IN     AA     CRPP   DIA
MA     BI     BC     BS     ODY    EL     MX     AI;

InvCost = 5641440

OpCost = 12772500

Tlmc_HP1stageMT [*] :=
1  279.497
2  280.497
3  282.497
4  284.497
5  285.497
6  276.497
;

CO2 = 412809

heat_recovery :=
DC      1    357.011
DC      2    356.967
DC      3    335.21
DC      4    343.394
DC      6    357.897
Vent    1      0.549
Vent    2      0.536
Vent    3      0.263
Vent    4      0.222
Vent    5      0.131
Vent    6      0.789
Vent_HP 1   1577.79
Vent_HP 2   1542.22
Vent_HP 3    757.489
Vent_HP 4    638.682
Vent_HP 5    428.859
Vent_HP 6   2023.78
;

use_recovery [*] :=
;

mult_t [*,*]
:                  1           2           3          4          5       :=
ElecGridBuy    16.9408     16.5736      9.21635    9.29191    2.24497
Geothermal      0.537709    0.537709    0.280999   0.537709   0
HP1stageLT     10          10           0          0          0
HP1stageMT     10          10           0          0          0
HP2stage        6.63321     5.99577     0          0          0
PV              2.7728      2.35895    16.7195     3.64188    4.01435

:                  6        :=
Boiler         10
Cogen           9.70012
ElecGridSell   14.3735
Geothermal      0.537709
HP1stageLT     10
HP1stageMT     10
HP2stage        6.63321
NatGasGrid     58.8969
;

use_t [*,*]
:              1   2   3   4   5   6    :=
Boiler         0   0   0   0   0   1
Cogen          0   0   0   0   0   1
ElecGridBuy    1   1   1   1   1   0
ElecGridSell   0   0   0   0   0   1
Geothermal     1   1   1   1   0   1
HP1stageLT     1   1   0   0   0   1
HP1stageMT     1   1   0   0   0   1
HP2stage       1   1   0   0   0   1
NatGasGrid     0   0   0   0   0   1
PV             1   1   1   1   1   0
;

ampl: reset;
ampl: include FinalSystem.run
CPLEX 12.9.0.0: optimal integer solution; objective 1786337.008
50 MIP simplex iterations
0 branch-and-bound nodes
Edemand [*] :=
1  12237.1
2  12237.1
3  12237.1
4  12237.1
5   2646.4
;

Qheating [*,*]
:         1           2           3            4           6        :=
AA     2851.88    2780.58     1207.35      969.169      4509.7
AI     3190.73    3131.68        0         523.128      6211.33
BC     1539.72    1512.53        0         273.703      2923.34
BI      272.84     267.091       0          31.3329      557.679
BM     2177.61    2134.01        0         408.809      4121.38
BP      746.685    733.003       0         147.305      1382.93
BS     1627.08    1601.22      156.512     505.349      2610.27
CE     3060.17    2985.82     1250.99     1049.72       4813.94
CH     2907.18    2853.8         0         258.291      6117.18
CM      975.389    955.272       0         125.033      1956.61
CO      531.966    521.782       0          25.6128     1154.86
CRPP    721.778    708.05        0           0          1681.39
DIA     125.378    123.587      11.9562     41.8779      193.488
EL     1173.45    1157.52        0         121.965      2379.52
GC     2051.53    2014.48        0         391.211      3832.08
GR      411.598    398.643      56.0567     41.0322      868.129
IN     1562.2     1530.73        0         251.163      3029.32
MA     1467.12    1427.46        0           0          4110.62
ME      512.056    491.531       0           0          1818.67
MX     1671.82    1651.78        0          36.5923     3697.55
ODY     515.963    506.154     127.119     175.297       799.736
PH     1761.33    1740.58        0           0          4431.79
PO       44.29      43.3786      0           0.499354    100.782
TCV     110.546    102.196       0           0           869.385
;

Qheatingdemand :=
LowT    1   19103.2
LowT    2   18729.7
LowT    3    1502.94
LowT    4    3480.47
LowT    6   37483.7
MediumT 1   12907.1
MediumT 2   12643.1
MediumT 3    1307.05
MediumT 4    1896.62
MediumT 6   26688
;

Qheatingsupply [*] :=
    Boiler    500
     Cogen   2800.11
Geothermal  10000
HP1stageLT   1000
HP1stageMT   1000
  HP2stage   1000
      SOFC     30
;

mult [*] :=
       Cogen    11.4854
 ElecGridBuy  1000
ElecGridSell  1000
    HP2stage    31.6533
  NatGasGrid  1000
;

mult_t :=
Cogen        6   11.4854
ElecGridBuy  1   25.6387
ElecGridBuy  2   25.2366
ElecGridBuy  3   12.9065
ElecGridBuy  4   13.4913
ElecGridBuy  5    2.6464
ElecGridSell 6   10.9701
HP2stage     1   31.6533
HP2stage     2   31.0159
HP2stage     3    2.47478
HP2stage     4    5.0337
HP2stage     6   31.6533
NatGasGrid   6   63.1589
;

Flowin :=
Biogas      SOFC            109.729
Electricity ElecGridSell   1000
Natgas      Boiler          555.556
Natgas      Cogen          5499.04
;

Flowout :=
Electricity Cogen         2000
Electricity ElecGridBuy   1000
Electricity Geothermal    4800
Electricity PV             100
Electricity SOFC            58
Natgas      NatGasGrid    1000
;

FlowInUnit :=
Electricity ElecGridSell 6   10970.1
Electricity HP2stage     1   13401.6
Electricity HP2stage     2   12999.5
Electricity HP2stage     3     669.386
Electricity HP2stage     4    1254.2
Electricity HP2stage     6   12000.8
Natgas      Cogen        6   63158.9
;

FlowOutUnit :=
Electricity Cogen       6   22970.9
Electricity ElecGridBuy 1   25638.7
Electricity ElecGridBuy 2   25236.6
Electricity ElecGridBuy 3   12906.5
Electricity ElecGridBuy 4   13491.3
Electricity ElecGridBuy 5    2646.4
Natgas      NatGasGrid  6   63158.9
;

set Buildings :=
GC     GR     CH     CO     TCV    ME     PO     BM
CE     CM     PH     BP     IN     AA     CRPP   DIA
MA     BI     BC     BS     ODY    EL     MX     AI;

InvCost = 3005830

OpCost = 17769700

Tlmc_HP1stageMT [*] :=
1  279.497
2  280.497
3  282.497
4  284.497
5  285.497
6  276.497
;

CO2 = 566846

heat_recovery :=
DC      1    357.011
DC      2    356.967
DC      3    335.21
DC      4    343.394
DC      6    357.897
Vent    1      0.549
Vent    2      0.536
Vent    3      0.263
Vent    4      0.222
Vent    5      0.131
Vent    6      0.789
Vent_HP 1   1577.79
Vent_HP 2   1542.22
Vent_HP 3    757.489
Vent_HP 4    638.682
Vent_HP 5    428.859
Vent_HP 6   2023.78
;

use_recovery [*] :=
     DC  1
;

mult_t :=
Cogen        6   11.4854
ElecGridBuy  1   25.6387
ElecGridBuy  2   25.2366
ElecGridBuy  3   12.9065
ElecGridBuy  4   13.4913
ElecGridBuy  5    2.6464
ElecGridSell 6   10.9701
HP2stage     1   31.6533
HP2stage     2   31.0159
HP2stage     3    2.47478
HP2stage     4    5.0337
HP2stage     6   31.6533
NatGasGrid   6   63.1589
;

use_t :=
Cogen        6   1
ElecGridBuy  1   1
ElecGridBuy  2   1
ElecGridBuy  3   1
ElecGridBuy  4   1
ElecGridBuy  5   1
ElecGridSell 6   1
HP2stage     1   1
HP2stage     2   1
HP2stage     3   1
HP2stage     4   1
HP2stage     6   1
NatGasGrid   6   1
;

ampl: reset;
ampl: include FinalSystem.run
CPLEX 12.9.0.0: optimal integer solution; objective 9413355.15
32 MIP simplex iterations
0 branch-and-bound nodes
Edemand [*] :=
1  12237.1
2  12237.1
3  12237.1
4  12237.1
5   2646.4
;

Qheating [*,*]
:         1           2           3            4           6        :=
AA     2851.88    2780.58     1207.35      969.169      4509.7
AI     3190.73    3131.68        0         523.128      6211.33
BC     1539.72    1512.53        0         273.703      2923.34
BI      272.84     267.091       0          31.3329      557.679
BM     2177.61    2134.01        0         408.809      4121.38
BP      746.685    733.003       0         147.305      1382.93
BS     1627.08    1601.22      156.512     505.349      2610.27
CE     3060.17    2985.82     1250.99     1049.72       4813.94
CH     2907.18    2853.8         0         258.291      6117.18
CM      975.389    955.272       0         125.033      1956.61
CO      531.966    521.782       0          25.6128     1154.86
CRPP    721.778    708.05        0           0          1681.39
DIA     125.378    123.587      11.9562     41.8779      193.488
EL     1173.45    1157.52        0         121.965      2379.52
GC     2051.53    2014.48        0         391.211      3832.08
GR      411.598    398.643      56.0567     41.0322      868.129
IN     1562.2     1530.73        0         251.163      3029.32
MA     1467.12    1427.46        0           0          4110.62
ME      512.056    491.531       0           0          1818.67
MX     1671.82    1651.78        0          36.5923     3697.55
ODY     515.963    506.154     127.119     175.297       799.736
PH     1761.33    1740.58        0           0          4431.79
PO       44.29      43.3786      0           0.499354    100.782
TCV     110.546    102.196       0           0           869.385
;

Qheatingdemand :=
LowT    1   19103.2
LowT    2   18729.7
LowT    3    1502.94
LowT    4    3480.47
LowT    6   37483.7
MediumT 1   12907.1
MediumT 2   12643.1
MediumT 3    1307.05
MediumT 4    1896.62
MediumT 6   26688
;

Qheatingsupply [*] :=
    Boiler    500
     Cogen   2800.11
Geothermal  10000
HP1stageLT   1000
HP1stageMT   1000
  HP2stage   1000
      SOFC     30
;

mult [*] :=
      Boiler    10
       Cogen     9.70012
 ElecGridBuy  1000
ElecGridSell  1000
  Geothermal     0.537709
  HP1stageLT    10
  HP1stageMT    10
    HP2stage     6.63321
  NatGasGrid  1000
          PV    16.7195
;

mult_t [*,*]
:                  1           2           3          4          5       :=
ElecGridBuy    16.9408     16.5736      9.21635    9.29191    2.24497
Geothermal      0.537709    0.537709    0.280999   0.537709   0
HP1stageLT     10          10           0          0          0
HP1stageMT     10          10           0          0          0
HP2stage        6.63321     5.99577     0          0          0
PV              2.7728      2.35895    16.7195     3.64188    4.01435

:                  6        :=
Boiler         10
Cogen           9.70012
ElecGridSell   14.3735
Geothermal      0.537709
HP1stageLT     10
HP1stageMT     10
HP2stage        6.63321
NatGasGrid     58.8969
;

Flowin :=
Biogas      SOFC            109.729
Electricity ElecGridSell   1000
Natgas      Boiler          555.556
Natgas      Cogen          5499.04
;

Flowout :=
Electricity Cogen         2000
Electricity ElecGridBuy   1000
Electricity Geothermal    4800
Electricity PV             100
Electricity SOFC            58
Natgas      NatGasGrid    1000
;

FlowInUnit :=
Electricity ElecGridSell 6   14373.5
Electricity HP1stageLT   1    2069.68
Electricity HP1stageLT   2    2012.03
Electricity HP1stageLT   6    2242.62
Electricity HP1stageMT   1    2683.89
Electricity HP1stageMT   2    2628.44
Electricity HP1stageMT   6    2850.24
Electricity HP2stage     1    2808.43
Electricity HP2stage     2    2512.97
Electricity HP2stage     6    2514.86
Natgas      Boiler       6    5555.56
Natgas      Cogen        6   53341.3
;

FlowOutUnit :=
Electricity Cogen       6   19400.2
Electricity ElecGridBuy 1   16940.8
Electricity ElecGridBuy 2   16573.6
Electricity ElecGridBuy 3    9216.35
Electricity ElecGridBuy 4    9291.91
Electricity ElecGridBuy 5    2244.97
Electricity Geothermal  1    2581
Electricity Geothermal  2    2581
Electricity Geothermal  3    1348.8
Electricity Geothermal  4    2581
Electricity Geothermal  6    2581
Electricity PV          1     277.28
Electricity PV          2     235.895
Electricity PV          3    1671.95
Electricity PV          4     364.188
Electricity PV          5     401.435
Natgas      NatGasGrid  6   58896.9
;

set Buildings :=
GC     GR     CH     CO     TCV    ME     PO     BM
CE     CM     PH     BP     IN     AA     CRPP   DIA
MA     BI     BC     BS     ODY    EL     MX     AI;

InvCost = 5641440

OpCost = 12772500

Tlmc_HP1stageMT [*] :=
1  279.497
2  280.497
3  282.497
4  284.497
5  285.497
6  276.497
;

CO2 = 412809

heat_recovery :=
DC      1    357.011
DC      2    356.967
DC      3    335.21
DC      4    343.394
DC      6    357.897
Vent    1      0.549
Vent    2      0.536
Vent    3      0.263
Vent    4      0.222
Vent    5      0.131
Vent    6      0.789
Vent_HP 1   1577.79
Vent_HP 2   1542.22
Vent_HP 3    757.489
Vent_HP 4    638.682
Vent_HP 5    428.859
Vent_HP 6   2023.78
;

use_recovery [*] :=
;

mult_t [*,*]
:                  1           2           3          4          5       :=
ElecGridBuy    16.9408     16.5736      9.21635    9.29191    2.24497
Geothermal      0.537709    0.537709    0.280999   0.537709   0
HP1stageLT     10          10           0          0          0
HP1stageMT     10          10           0          0          0
HP2stage        6.63321     5.99577     0          0          0
PV              2.7728      2.35895    16.7195     3.64188    4.01435

:                  6        :=
Boiler         10
Cogen           9.70012
ElecGridSell   14.3735
Geothermal      0.537709
HP1stageLT     10
HP1stageMT     10
HP2stage        6.63321
NatGasGrid     58.8969
;

use_t [*,*]
:              1   2   3   4   5   6    :=
Boiler         0   0   0   0   0   1
Cogen          0   0   0   0   0   1
ElecGridBuy    1   1   1   1   1   0
ElecGridSell   0   0   0   0   0   1
Geothermal     1   1   1   1   0   1
HP1stageLT     1   1   0   0   0   1
HP1stageMT     1   1   0   0   0   1
HP2stage       1   1   0   0   0   1
NatGasGrid     0   0   0   0   0   1
PV             1   1   1   1   1   0
;

ampl: reset;
ampl: include FinalSystem.run
CPLEX 12.9.0.0: optimal integer solution; objective 734054.9948
28 MIP simplex iterations
0 branch-and-bound nodes
Edemand [*] :=
1  12237.1
2  12237.1
3  12237.1
4  12237.1
5   2646.4
;

Qheating [*,*]
:         1           2           3            4           6        :=
AA     2851.88    2780.58     1207.35      969.169      4509.7
AI     3190.73    3131.68        0         523.128      6211.33
BC     1539.72    1512.53        0         273.703      2923.34
BI      272.84     267.091       0          31.3329      557.679
BM     2177.61    2134.01        0         408.809      4121.38
BP      746.685    733.003       0         147.305      1382.93
BS     1627.08    1601.22      156.512     505.349      2610.27
CE     3060.17    2985.82     1250.99     1049.72       4813.94
CH     2907.18    2853.8         0         258.291      6117.18
CM      975.389    955.272       0         125.033      1956.61
CO      531.966    521.782       0          25.6128     1154.86
CRPP    721.778    708.05        0           0          1681.39
DIA     125.378    123.587      11.9562     41.8779      193.488
EL     1173.45    1157.52        0         121.965      2379.52
GC     2051.53    2014.48        0         391.211      3832.08
GR      411.598    398.643      56.0567     41.0322      868.129
IN     1562.2     1530.73        0         251.163      3029.32
MA     1467.12    1427.46        0           0          4110.62
ME      512.056    491.531       0           0          1818.67
MX     1671.82    1651.78        0          36.5923     3697.55
ODY     515.963    506.154     127.119     175.297       799.736
PH     1761.33    1740.58        0           0          4431.79
PO       44.29      43.3786      0           0.499354    100.782
TCV     110.546    102.196       0           0           869.385
;

Qheatingdemand :=
LowT    1   19103.2
LowT    2   18729.7
LowT    3    1502.94
LowT    4    3480.47
LowT    6   37483.7
MediumT 1   12907.1
MediumT 2   12643.1
MediumT 3    1307.05
MediumT 4    1896.62
MediumT 6   26688
;

Qheatingsupply [*] :=
    Boiler    500
     Cogen   2800.11
Geothermal  10000
HP1stageLT   1000
HP1stageMT   1000
  HP2stage   1000
      SOFC     30
;

mult [*] :=
      Boiler    10
 ElecGridBuy  1000
ElecGridSell  1000
  Geothermal     1
  HP1stageLT    10
  HP1stageMT    10
    HP2stage    29.1717
  NatGasGrid  1000
          PV    16.7195
;

mult_t [*,*]
:                 1         2           3          4          5         6    :=
Boiler          0         0          0          0          0         10
ElecGridBuy    12.7645   12.4171     9.21635    9.29191    2.24497   11.3528
Geothermal      1         1          0.280999   0.537709   0          1
HP1stageLT     10        10          0          0          0         10
HP1stageMT     10        10          0          0          0         10
HP2stage        2.0103    1.37287    0          0          0         29.1717
NatGasGrid      0         0          0          0          0          5.55556
PV              2.7728    2.35895   16.7195     3.64188    4.01435    0
;

Flowin :=
Biogas      SOFC            109.729
Electricity ElecGridSell   1000
Natgas      Boiler          555.556
Natgas      Cogen          5499.04
;

Flowout :=
Electricity Cogen         2000
Electricity ElecGridBuy   1000
Electricity Geothermal    4800
Electricity PV             100
Electricity SOFC            58
Natgas      NatGasGrid    1000
;

FlowInUnit :=
Electricity HP1stageLT 1    2069.68
Electricity HP1stageLT 2    2012.03
Electricity HP1stageLT 6    2242.62
Electricity HP1stageMT 1    2683.89
Electricity HP1stageMT 2    2628.44
Electricity HP1stageMT 6    2850.24
Electricity HP2stage   1     851.138
Electricity HP2stage   2     575.401
Electricity HP2stage   6   11059.9
Natgas      Boiler     6    5555.56
;

FlowOutUnit :=
Electricity ElecGridBuy 1   12764.5
Electricity ElecGridBuy 2   12417.1
Electricity ElecGridBuy 3    9216.35
Electricity ElecGridBuy 4    9291.91
Electricity ElecGridBuy 5    2244.97
Electricity ElecGridBuy 6   11352.8
Electricity Geothermal  1    4800
Electricity Geother