CPLEX 12.9.0.0: optimal (non-)integer solution; objective 14487199.67
70 MIP simplex iterations
0 branch-and-bound nodes
3 integer variables rounded (maxerr = 5.60022e-07).
Assigning integrality = 3e-07 might help.
Currently integrality = 1e-05.
Edemand [*] :=
1  12237.1
2  12237.1
3  12237.1
4  12237.1
5   2646.4
;

Qheating [*,*]
:         1           2           3            4           6        :=
AA     2851.88    2780.58     1207.35      969.169      4509.7
AI     3190.73    3131.68        0         523.128      6211.33
BC     1539.72    1512.53        0         273.703      2923.34
BI      272.84     267.091       0          31.3329      557.679
BM     2177.61    2134.01        0         408.809      4121.38
BP      746.685    733.003       0         147.305      1382.93
BS     1627.08    1601.22      156.512     505.349      2610.27
CE     3060.17    2985.82     1250.99     1049.72       4813.94
CH     2907.18    2853.8         0         258.291      6117.18
CM      975.389    955.272       0         125.033      1956.61
CO      531.966    521.782       0          25.6128     1154.86
CRPP    721.778    708.05        0           0          1681.39
DIA     125.378    123.587      11.9562     41.8779      193.488
EL     1173.45    1157.52        0         121.965      2379.52
GC     2051.53    2014.48        0         391.211      3832.08
GR      411.598    398.643      56.0567     41.0322      868.129
IN     1562.2     1530.73        0         251.163      3029.32
MA     1467.12    1427.46        0           0          4110.62
ME      512.056    491.531       0           0          1818.67
MX     1671.82    1651.78        0          36.5923     3697.55
ODY     515.963    506.154     127.119     175.297       799.736
PH     1761.33    1740.58        0           0          4431.79
PO       44.29      43.3786      0           0.499354    100.782
TCV     110.546    102.196       0           0           869.385
;

Qheatingdemand :=
LowT    1   19103.2
LowT    2   18729.7
LowT    3    1502.94
LowT    4    3480.47
LowT    6   37483.7
MediumT 1   12907.1
MediumT 2   12643.1
MediumT 3    1307.05
MediumT 4    1896.62
MediumT 6   26688
;

Qheatingsupply [*] :=
      Boiler    500
       Cogen   2800.11
  Geothermal  10000
  HP1stageLT   1000
HP1stageLT_2   1000
  HP1stageMT   1000
HP1stageMT_2   1000
    HP2stage   1000
        SOFC     30
;

mult [*] :=
       Cogen    11.4858
 ElecGridBuy  1000
ElecGridSell  1000
  Geothermal     0.348047
  HP1stageLT    10
  HP1stageMT    10
    HP2stage     8.52983
  NatGasGrid  1000
          PV    16.7195
;

mult_t [*,*]
:                  1           2           3           4          5       :=
ElecGridBuy    18.6542     18.2789     10.0916     10.5402     2.24497
Geothermal      0.348047    0.348047    0.150294    0.348047   0
HP1stageLT     10          10           1.30705     1.89662    0
HP1stageMT     10          10           0           0          0
HP2stage        8.52983     7.8924      0           0          0
PV              2.7728      2.35895    16.7195      3.64188    4.01435

:                  6        :=
Cogen          11.4858
ElecGridSell   16.3154
Geothermal      0.348047
HP1stageLT     10
HP1stageMT     10
HP2stage        8.52983
NatGasGrid     63.1606
;

Fmax [*] :=
      Boiler    10
       Cogen   225
 ElecGridBuy  1000
ElecGridSell  1000
  Geothermal     1
  HP1stageLT    10
HP1stageLT_2    10
  HP1stageMT    10
HP1stageMT_2    10
    HP2stage    50
HPDatacenter  1000
     HPWaste  1000
  NatGasGrid  1000
          PV  1000
        SOFC  8620
;

Flowin :=
Biogas      SOFC            109.729
Electricity ElecGridSell   1000
Natgas      Boiler          555.556
Natgas      Cogen          5499.04
;

Flowout :=
Electricity Cogen         2000
Electricity ElecGridBuy   1000
Electricity Geothermal    4800
Electricity PV             100
Electricity SOFC            58
Natgas      NatGasGrid    1000
;

FlowInUnit :=
Electricity ElecGridSell 6   16315.4
Electricity HP1stageLT   1    2069.68
Electricity HP1stageLT   2    2012.03
Electricity HP1stageLT   3     247.913
Electricity HP1stageLT   4     337.872
Electricity HP1stageLT   6    2242.62
Electricity HP1stageMT   1    2683.89
Electricity HP1stageMT   2    2628.44
Electricity HP1stageMT   6    2850.24
Electricity HP2stage     1    3611.43
Electricity HP2stage     2    3307.89
Electricity HP2stage     6    3233.93
Natgas      Cogen        6   63160.6
;

FlowOutUnit :=
Electricity Cogen       6   22971.5
Electricity ElecGridBuy 1   18654.2
Electricity ElecGridBuy 2   18278.9
Electricity ElecGridBuy 3   10091.6
Electricity ElecGridBuy 4   10540.2
Electricity ElecGridBuy 5    2244.97
Electricity Geothermal  1    1670.63
Electricity Geothermal  2    1670.63
Electricity Geothermal  3     721.411
Electricity Geothermal  4    1670.63
Electricity Geothermal  6    1670.63
Electricity PV          1     277.28
Electricity PV          2     235.895
Electricity PV          3    1671.95
Electricity PV          4     364.188
Electricity PV          5     401.435
Natgas      NatGasGrid  6   63160.6
;

usedroofArea = 15500

InvCost = 4982980

OpCost = 11982700

CO2 = 442205

heat_recovery :=
DC      1    357.011
DC      2    356.967
DC      3    335.21
DC      4    343.394
DC      6    357.897
Vent    1      0.549
Vent    2      0.536
Vent    3      0.263
Vent    4      0.222
Vent    5      0.131
Vent    6      0.789
Vent_HP 1   1577.79
Vent_HP 2   1542.22
Vent_HP 3    757.489
Vent_HP 4    638.682
Vent_HP 5    428.859
Vent_HP 6   2023.78
;

use_recovery [*] :=
;

FlowInUnitSum :=
Electricity ElecGridSell   16315.4
Electricity HP1stageLT      6910.11
Electricity HP1stageMT      8162.58
Electricity HP2stage       10153.3
Natgas      Cogen          63160.6
;

FlowOutUnitSum :=
Electricity Cogen         22971.5
Electricity ElecGridBuy   59809.9
Electricity Geothermal     7403.91
Electricity PV             2950.75
Natgas      NatGasGrid    63160.6
;

